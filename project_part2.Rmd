---
title: "Statistical Inference Part 2"
author: "Nazmi Anik"
date: "Friday, October 23, 2015"
output: html_document
---

## Overview  

We are going to analyze the ToothGrowth data in the R datasets package. A basic summary of the data will be provided. We will use confidence intervals and/or hypothesis tests to compare tooth growth by supplement (vitamin c and ascorbic acid) and dose.  

## Load & Explore the Data  

We will load the data from the R package dataset.  

```{r load, echo=TRUE}
#load the data
data(ToothGrowth)
#do a quick summary to see what is inside
str(ToothGrowth)
```

Let's first load the libraries we will be using throughout our analysis.  

```{r library, message=FALSE}
#import ggplot andl dplyr libraries
library(ggplot2)
library(dplyr)
```

Now let's try to visualize the data with some boxplots. That will enable us to see the mean and variance in tooth growth with different dosages of each supplement.  

```{r boxplot1, echo=TRUE, fig.height=3.5, fig.width=5}
g <- ggplot(data = ToothGrowth, aes(x = factor(dose), y = len)) + geom_boxplot() + facet_grid(.~supp) + 
    xlab("Dose") + ylab("Tooth Length") + ggtitle("Tooth Growth with Different Supplements")
g
```

Here's another boxplot to see the mean and variance in tooth growth with different supplements for each dosage.
```{r boxplot2, echo=TRUE, fig.height=3.5, fig.width=5}
h <- ggplot(data = ToothGrowth, aes(x = factor(supp), y = len)) + geom_boxplot() + facet_grid(.~dose) + 
    xlab("Supplement") + ylab("Tooth Length") + ggtitle("Tooth Growth with Different Dosages")
h
```

It is clear from the plots that higher dosage of the supplements cause more tooth growth. The effects of using different supplements is less clear as their effects seems to be similar.  

## Basic Summary of Data  

Let's take a basic look at the data.  

```{r summary, echo=TRUE}
#group the data by dose and then by supplement
growth <- group_by(ToothGrowth, dose, supp)
#add mean and standard deviation to the summary table
growthSummary <- summarize(growth, mean = mean(len), standard.deviation = sd(len))
growthSummary
```

## Tooth Growth Comparison  

### Assumptions  

Due to the small sized sample (total of 60 observations), we will use t test to compare tooth growth by supplementals and dosage. We cannot use paired t tests because we are assuming that the pigs were chosen randomly and therefore are independent from different samples. Therefore, paired = FALSE for all the t tests.  
We are assuming that the variances between separate groups of pigs are the same since the number of observations are the same (ten) for each test. This follows from the assumption that 10 different pigs each time approximately represent the population. Therefore, var.equal = TRUE for all the t tests.  

### Comparison  

Based on our assumptions, let's test:  
* Low Dose:  
```{r lowdose, echo=TRUE}
growthLow <- subset(ToothGrowth, dose == 0.5)
t1 <- t.test(len~supp,paired=FALSE,var.equal=TRUE,data=growthLow)
```

* Medium Dose:  
```{r meddose, echo=TRUE}
growthMed <- subset(ToothGrowth, dose == 1.0)
t2 <- t.test(len~supp,paired=FALSE,var.equal=TRUE,data=growthMed)
```

* High Dose:
```{r meddose, echo=TRUE}
growthHi<- subset(ToothGrowth, dose == 2.0)
t3 <- t.test(len~supp,paired=FALSE,var.equal=TRUE,data=growthHi)
```